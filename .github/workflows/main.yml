name: tags

on:
  push:
    branches:
      - main

jobs:
  create-tag:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3


      - name: Create and push tag
        run: |
          LAST_TAG=$(git tag -l --sort=-v:refname | head -n 1)
          LAST_VERSION=$(echo $LAST_TAG | sed 's/build-0.0.//')
          if [ -z ${LAST_VERSION+x} ]; then LAST_VERSION="0"; fi
          declare -a ARR=($(echo $LAST_VERSION| sed -e s/build-0.0//g | tr -s "." " " | xargs -n 1))
          MINOR=${ARR[0]}
          NEXT_MINOR=$((MINOR + 1))
          NEXT_VERSION="$MINOR"
          TAG_NAME="build-0.0.$NEXT_VERSION"
          git tag $TAG_NAME
          git push --tags
